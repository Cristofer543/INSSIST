!function(){var n={createName:function(n,t){return`${n}|${JSON.stringify(t)}`},getName:t,getParams:function(){return function(n){try{return JSON.parse(n)}catch(n){return null}}(window.self.name.split("|")[1])||{}},isIframe:function(n=null){return window.self!==parent&&(!n||t()===n)}};function t(){return window.self.name.split("|")[0]||null}function e(n){const t=document.createElement("div"),e=n.replace("<script>","(() => {").replace("<\/script>","})()");t.setAttribute("onreset",e),t.dispatchEvent(new Event("reset"))}var r={};Object.assign(r,{executeScript:e,loadExtScript:function(n,t={}){const e=Math.random().toString().slice(2),r=document.createElement("script");r.onload=()=>r.remove(),r.src=chrome.runtime.getURL(`${n}?v=${e}`),document.documentElement.insertAdjacentElement("afterbegin",r);for(const n in t)r.setAttribute(n,t[n])},iframe:n});var i=document.documentElement,o=function(){e(`\n      <script>\n        window.inssist.theme.emojiRegex = ${window.emojiRegex.toString()}\n      <\/script>\n    `)};var s={init:function(){!function(){const t=n.getParams().theme;if(!t)return;i.classList.add(`theme-${t}`)}(),i.insertAdjacentHTML("afterbegin",'\n    <svg id="theme-night-svg" style="display: none; height: 0px; width: 0px;">\n      <filter id="theme-filter" x="0" y="0" width="99999" height="99999" style="color-interpolation-filters: srgb;">\n        <feColorMatrix type="matrix" values="0.300 -0.600 -0.600 0.000 0.950 -0.600 0.300 -0.600 0.000 0.950 -0.600 -0.600 0.300 0.000 0.950 0.000 0.000 0.000 1.000 0.000"></feColorMatrix>\n      </filter>\n      <filter id="theme-reverse-filter" x="0" y="0" width="99999" height="99999" style="color-interpolation-filters: srgb;">\n        <feColorMatrix type="matrix" values="0.333 -0.667 -0.667 0.000 1.015 -0.667 0.333 -0.667 0.000 1.015 -0.667 -0.667 0.333 0.000 1.015 0.000 0.000 0.000 1.000 0.000"></feColorMatrix>\n      </filter>\n    </svg>\n  '),i.insertAdjacentHTML("afterbegin",'\n    <style>\n      .theme-night {\n        filter: url(#theme-filter) !important;\n        text-shadow: 0 0 0 !important;\n        background: #191919 !important;\n      }\n\n      .theme-night ._cqw45._2pnef,\n      .theme-night ._mli86,\n      .theme-night :not(object):not(body)>embed,\n      .theme-night [background],\n      .theme-night [style*="background-image: url"],\n      .theme-night [style*="background-image:url"],\n      .theme-night [style*="background: url"],\n      .theme-night [style*="background:url"],\n      .theme-night img,\n      .theme-night object,\n      .theme-night svg image,\n      .theme-night video {\n        -webkit-filter: url(#theme-reverse-filter) !important;\n        filter: url(#theme-reverse-filter) !important;\n      }\n\n      .theme-night [background] *,\n      .theme-night [style*="background-image: url"] *,\n      .theme-night [style*="background-image:url"] *,\n      .theme-night [style*="background: url"] *,\n      .theme-night [style*="background:url"] *,\n      .theme-night img[src^="https://s0.wp.com/latex.php"],\n      .theme-night input .NaturalImage-image {\n        -webkit-filter: none !important;\n        filter: none !important;\n      }\n\n      .theme-night :-webkit-full-screen,\n      .theme-night :-webkit-full-screen * {\n        -webkit-filter: none !important;\n        filter: none !important;\n      }\n\n      .theme-night :-moz-full-screen,\n      .theme-night :-moz-full-screen * {\n        -webkit-filter: none !important;\n        filter: none !important;\n      }\n\n      .theme-night :fullscreen,\n      .theme-night :fullscreen * {\n        -webkit-filter: none !important;\n        filter: none !important;\n      }\n    </style>\n  '),o()}};var a={controller:{init:function(){(function(){if(Array.prototype.flat)return;Array.prototype.flat=function(){const n=[...this],t=[];for(const e of n)Array.isArray(e)?t.push(...e):t.push(e);return t}})(),String.prototype.replaceAll||(String.prototype.replaceAll=function(n,t){return this.split(n).join(t)})}}},l={init:function(){r.executeScript("\n    <script>\n      window.inssist.modulePatcher = {\n        // onModuleInit(({ moduleName, args, bodyStr, setBodyStr }) => {...})\n        onModuleInit,\n      }\n\n\n      const handlers = []\n\n\n      function onModuleInit (handler) {\n        handlers.push(handler)\n      }\n\n\n      // patch __d function so we can modify modules body\n      let __d\n      Object.defineProperty(Object.prototype, '__d', {\n        get () {\n          return (...args) => {\n            // check __d args\n            const fn = args[2]\n            if (typeof fn !== 'function') {\n              return __d(...args)\n            }\n\n            // extract module's function body as a string\n            const fnStr = fn.toString()\n            const argsStr = fnStr.split('(')[1].split(')')[0]\n            const bodyStartIndex = fnStr.indexOf('{')\n            const bodyEndIndex = fnStr.lastIndexOf('}')\n            let bodyStr = fnStr.slice(bodyStartIndex + 1, bodyEndIndex)\n\n            const setBodyStr = (newBodyStr) => {\n              bodyStr = newBodyStr\n              const newFn = new Function(argsStr, bodyStr)\n              args[2] = newFn\n            }\n\n            // call handlers which can modify current module\n            const moduleName = args[0]\n            handlers.forEach(handler => {\n              handler({\n                moduleName,\n                args,\n                bodyStr,\n                setBodyStr,\n              })\n            })\n\n            return __d(...args)\n          }\n        },\n        set (value) {\n          __d = value\n          return true\n        },\n      })\n    <\/script>\n  ")}};var c={init:function(){r.executeScript("\n    <script>\n      const modulePatcher = window.inssist.modulePatcher\n\n\n      modulePatcher.onModuleInit(\n        ({ moduleName, bodyStr, setBodyStr }) => {\n          // ignore these modules because patching fails for them\n          if (\n            moduleName === 'ReactPropTransfererCore' ||\n            moduleName === 'TooltipData'\n          ) { return }\n\n          if (!bodyStr.includes('className:')) { return }\n\n          // generate class name\n          const className = moduleName\n            .replace('.react', '')\n            .split('.').join('_')\n\n          // add generated class name to className field\n          const newBodyStr = bodyStr\n            .replace(/className:([\"a-z][^?]{20})/g, 'className:\"' + className + ' \"+$1')\n\n          setBodyStr(newBodyStr)\n        }\n      )\n    <\/script>\n  ")}};function m(){r.executeScript("\n    <script>\n      window.inssist = {\n        theme: {},\n        schedule: {},\n        modulePatcher: null,\n      }\n    <\/script>\n  ")}({init:function(){a.controller.init(),m(),s.init(),r.loadExtScript("/app/fb-nj.js"),r.iframe.isIframe("inssist-fcs")&&(document.documentElement.insertAdjacentHTML("afterbegin",'\n    <link\n      href="https://fonts.googleapis.com/css?family=Montserrat:400,500,600,700|Nunito+Sans&display=fallback&subset=cyrillic,cyrillic-ext,latin-ext,vietnamese"\n      rel="stylesheet"/>\n  '),r.executeScript("\n    <script>\n      document.write = function () {}\n    <\/script>\n  "),l.init(),c.init())}}).init()}();